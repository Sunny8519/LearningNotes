## App优化之垃圾回收机制

### 1. 什么是GC？

GC是Garbage Collection(垃圾回收)的缩写，也可以翻译成Garbage Collector(垃圾回收器)。

垃圾回收器：Java中的自动内存管理机制；

垃圾回收：垃圾回收器中有一个进程是专门用来做垃圾回收工作的，这个进程就是垃圾回收，也就是我们常指的GC。

垃圾回收器的三大职责：

- 分配内存；
- 确保任何被引用的对象保留在内存中；
- 回收不能通过引用关系找到的对象内存。

### 2. 相关概念

Java虚拟机在程序运行期间把它所管理的内存分为若干个不同的数据区域，根据JVM规范，具体分为：程序计数器，Java虚拟机栈，本地方法栈，Java堆，方法区。

![这里写图片描述](http://img.blog.csdn.net/20160401142029373)

#### 2.1 程序计数器(Program Counter Register)

程序计数器占用很小的内存空间，它是当前线程所执行的字节码的行号指示器，字节码解释器工作时通过改变计数器的值来选择下一条需要执行的字节码指令。分支，跳转，循环等基础功能都需要依赖它来实现。它是线程私有的，每条线程都有一个独立的程序计数器，各线程间的计数器互不影响。

当线程在执行一个Java方法时，该计数器记录的是正在执行的字节码指令的地址，当线程在执行的是Native方法时，该计数器的值为空。

程序计数器是内存区域中唯一一个没有OOM的区域。

#### 2.1 Heap和Stack

Heap内存指的是Java运行环境中用来分配给对象和JRE类的内存区域。

Stack内存是相对于Thread来说的，每个Thread都有一个Stack内存，它保存了线程中方法内短期存在的变量以及对象的引用。Stack内存的特点是后进先出。我们通常所说的GC是针对Heap内存，因为Stack内存一般在方法调用完之后就会被销毁。

